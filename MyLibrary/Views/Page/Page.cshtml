@model List<MyLibrary.Models.Book>

@{
    ViewBag.Title = "My Library";
}

<style>
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background: #fdf6e3; /* Köhnə kitab səhifəsi effekti */
        color: #333;
    }

    /* Konteyner */
    .container {
        display: flex;
        min-height: 100vh;
    }

    /* Sol panel konteyneri */
    .sidebar-container {
        position: relative;
        width: 180px;
        display: flex;
        flex-direction: column;
    }

    /* Sidebar düymələr konteyneri */
    .sidebar-buttons {
        display: flex;
        flex-direction: column;
        gap: 15px;
        padding: 20px;
        background-color: rgba(255,255,255,0.2);
        backdrop-filter: blur(2px);
    }

        /* Buttons */
        .sidebar-buttons button {
            background: none;
            border: none;
            padding: 10px;
            cursor: pointer;
            transition: 0.3s;
            border-radius: 5px;
        }

            /* Hover effekti düymələrdə */
            .sidebar-buttons button:hover {
                background-color: rgba(0,0,0,0.1);
            }

    /* Divider (sol-sağ ayrıcı xətt) */
    .divider {
        position: absolute;
        top: 0;
        right: 0;
        width: 2px;
        height: 100%;
        background-color: rgba(0,0,0,0.2);
        transition: background-color 0.3s;
    }

    /* Hover zamanı xətt tündləşir */
    .sidebar-buttons button:hover ~ .divider {
        background-color: #333; /* tünd xətt */
    }

    /* Sağ content */
    .content {
        flex: 1;
        padding: 30px;
        overflow-y: auto;
    }

    /* My Books başlığı */
    h2 {
        margin-top: 0;
    }

    /* AddBook düyməsi My Books altında */
    #addBookBtn {
        display: inline-block;
        margin-bottom: 20px;
        padding: 10px 15px;
        background-color: rgba(255,255,255,0.2);
        border: none;
        border-radius: 5px;
        cursor: pointer;
        transition: 0.3s;
    }

        #addBookBtn:hover {
            border: 1px solid #333;
            background-color: rgba(0,0,0,0.1);
            color: #000;
        }

    /* Kitab siyahısı */
    .book-list {
        list-style: none;
        padding: 0;
    }

        .book-list li {
            margin-bottom: 20px;
            padding: 15px;
            background-color: rgba(255, 255, 255, 0.4);
            border-radius: 10px;
            box-shadow: 0 0 5px rgba(0,0,0,0.1);
        }

        .book-list img {
            margin-top: 5px;
            border-radius: 5px;
        }

    /* Modal */
    #bookModal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0,0,0,0.6);
        justify-content: center;
        align-items: center;
        z-index: 1000;
    }

        #bookModal .modal-content {
            background: rgba(255,255,255,0.95);
            padding: 25px;
            border-radius: 10px;
            width: 400px;
            max-width: 90%;
        }

        #bookModal input, #bookModal textarea {
            width: 100%;
            padding: 8px;
            margin-bottom: 10px;
            border-radius: 5px;
            border: 1px solid #ccc;
            font-size: 14px;
        }

        #bookModal button {
            padding: 8px 15px;
            margin-right: 10px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

            #bookModal button[type="submit"] {
                background-color: #333;
                color: #fff;
            }

            #bookModal button#closeModal {
                background-color: #ccc;
            }
</style>

<div class="container">
    <!-- Sol panel konteyneri -->
    <div class="sidebar-container">
        <div class="sidebar-buttons">
            <h3>@ViewBag.UserName</h3>
            <button onclick="location.href='@Url.Action("Libraries", "Library")'">All Libraries</button>
            <button onclick="location.href='@Url.Action("Login", "Account")'">Logout</button>
        </div>
        <div class="divider"></div>
    </div>

    <!-- Sağ content -->
    <div class="content">
        <h2>My Books</h2>
        <hr>
        <button id="addBookBtn">+ Add Book</button>

        <ul class="book-list">
            @foreach (var book in Model)
            {
                <li>
                    <strong>@book.Title</strong> <br />

                    <!-- Burda ImageUrl yox, ImageData istifadə edirsən -->
                    @if (book.ImageData != null)
                    {
                        <img src="data:image/png;base64,@(Convert.ToBase64String(book.ImageData))" style="width:120px;" />
                    }

                    <em>Notes:</em> @book.Notes <br />
                    <em>Thoughts:</em> @book.Thoughts
                </li>
            }
        </ul>

    </div>
</div>

<!-- Modal form -->
<div id="bookModal">
    <div class="modal-content">
        <h2>Add New Book</h2>
        <form asp-action="AddBook" method="post" enctype="multipart/form-data">
            <input type="text" name="Title" placeholder="Book Title" required />
    
            <!-- Şəkil yükləmə -->
            <label for="bookImage" style="cursor:pointer; color: #333; display:inline-block; margin-bottom:10px; border:1px solid #ccc; padding:8px; border-radius:5px; background-color: rgba(255,255,255,0.2);">
                Choose or Take Photo
            </label>
            <input type="file" id="bookImage" name="ImageFile" accept="image/*" capture="environment" style="display:none;" />

            <textarea name="Notes" placeholder="Notes about the book" rows="3"></textarea>
            <textarea name="Thoughts" placeholder="Your thoughts" rows="3"></textarea>
            <input type="hidden" name="UserId" value="@ViewBag.CurrentUserId" />
            <button type="submit">Add Book</button>
            <button type="button" id="closeModal">Cancel</button>
        </form>

    </div>
</div>

<script>
    const btn = document.getElementById('addBookBtn');
    const modal = document.getElementById('bookModal');
    const closeBtn = document.getElementById('closeModal');

    btn.addEventListener('click', () => {
        modal.style.display = 'flex';
    });

    closeBtn.addEventListener('click', () => {
        modal.style.display = 'none';
    });
</script>
